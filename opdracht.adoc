
https://en.wikipedia.org/wiki/X86_assembly_language

[,console]
----
file executable
----

[,console]
----
shasum -a 256 executable
----

[,console]
----
strings executable | grep -v ^[._]
----


[,console]
----
readelf -s executable
----

[,console]
----
-h header informatie
-l program headers info
-S section header info [ hoofdletter S ! ]
-s symbol info (symboltable)
----

https://www.gnu.org/software/gdb/documentation/

WORD betekend een 2-byte word


[,console]
----
gdb -batch -ex 'disassemble/rs main' executable | python beautify.py > main.asm
----

[,console]
----
   0x00000000000015c0 <+0>:  f3 0f 1e fa          endbr64                                 
   0x00000000000015c4 <+4>:  55                   push   %rbp                             
   0x00000000000015c5 <+5>:  48 89 e5             mov    %rsp,%rbp                        
   0x00000000000015c8 <+8>:  b8 00 00 00 00       mov    $0x0,%eax                        
   0x00000000000015cd <+13>: e8 eb fe ff ff       callq  0x14bd <__stack_quality_check>   
   0x00000000000015d2 <+18>: 48 8d 3d 4a 0c 00 00 lea    0xc4a(%rip),%rdi        # 0x2223 
   0x00000000000015d9 <+25>: e8 52 fb ff ff       callq  0x1130 <puts@plt>                
   0x00000000000015de <+30>: b8 00 00 00 00       mov    $0x0,%eax                        
   0x00000000000015e3 <+35>: e8 17 ff ff ff       callq  0x14ff <prepWork>                
   0x00000000000015e8 <+40>: b8 00 00 00 00       mov    $0x0,%eax                        
   0x00000000000015ed <+45>: e8 33 ff ff ff       callq  0x1525 <doWork>                  
   0x00000000000015f2 <+50>: b8 00 00 00 00       mov    $0x0,%eax                        
   0x00000000000015f7 <+55>: 5d                   pop    %rbp                             
   0x00000000000015f8 <+56>: c3                   retq  
----

[,console]
----
echo "set disassembly-flavor intel" > ~/.gdbinit
----

[,console]
----
   0x00000000000015c0 <+0>:  f3 0f 1e fa          endbr64                                
   0x00000000000015c4 <+4>:  55                   push   rbp                             
   0x00000000000015c5 <+5>:  48 89 e5             mov    rbp,rsp                         
   0x00000000000015c8 <+8>:  b8 00 00 00 00       mov    eax,0x0                         
   0x00000000000015cd <+13>: e8 eb fe ff ff       call   0x14bd <__stack_quality_check>  
   0x00000000000015d2 <+18>: 48 8d 3d 4a 0c 00 00 lea    rdi,[rip+0xc4a]        # 0x2223 
   0x00000000000015d9 <+25>: e8 52 fb ff ff       call   0x1130 <puts@plt>               
   0x00000000000015de <+30>: b8 00 00 00 00       mov    eax,0x0                         
   0x00000000000015e3 <+35>: e8 17 ff ff ff       call   0x14ff <prepWork>               
   0x00000000000015e8 <+40>: b8 00 00 00 00       mov    eax,0x0                         
   0x00000000000015ed <+45>: e8 33 ff ff ff       call   0x1525 <doWork>                 
   0x00000000000015f2 <+50>: b8 00 00 00 00       mov    eax,0x0                         
   0x00000000000015f7 <+55>: 5d                   pop    rbp                             
   0x00000000000015f8 <+56>: c3                   ret  
----


[,console]
----
1. de offset vanaf het begin van het bestand
2. de offset vanaf begin methode 
3. de binaire instructies
4. de assembly opcode
5. de parameters
----


[,console]
----
   0x00000000000015c0 <+0>:  f3 0f 1e fa          endbr64
   0x00000000000015c4 <+4>:  55                   push   rbp
   0x00000000000015c5 <+5>:  48 89 e5             mov    rbp,rsp
   0x00000000000015c8 <+8>:  b8 00 00 00 00       mov    eax,0x0
   0x00000000000015cd <+13>: e8 eb fe ff ff       call   0x14bd <__stack_quality_check>
   0x00000000000015d2 <+18>: 48 8d 3d 4a 0c 00 00 lea    rdi,[rip+0xc4a]        # 0x2223 
   0x00000000000015d9 <+25>: e8 52 fb ff ff       call   0x1130 <puts@plt>
   0x00000000000015de <+30>: b8 00 00 00 00       mov    eax,0x0
   0x00000000000015e3 <+35>: e8 17 ff ff ff       call   0x14ff <prepWork>
   0x00000000000015e8 <+40>: b8 00 00 00 00       mov    eax,0x0
   0x00000000000015ed <+45>: e8 33 ff ff ff       call   0x1525 <doWork>
   0x00000000000015f2 <+50>: b8 00 00 00 00       mov    eax,0x0
   0x00000000000015f7 <+55>: 5d                   pop    rbp
   0x00000000000015f8 <+56>: c3                   ret

~                                                                                                                                                       
~                                                                                                                                                       
~                                                                                                                                                       
~                                                                                                                                                       
~                                                   
:g/call/p
   0x00000000000015cd <+13>: e8 eb fe ff ff       call   0x14bd <__stack_quality_check>
   0x00000000000015d9 <+25>: e8 52 fb ff ff       call   0x1130 <puts@plt>
   0x00000000000015e3 <+35>: e8 17 ff ff ff       call   0x14ff <prepWork>
   0x00000000000015ed <+45>: e8 33 ff ff ff       call   0x1525 <doWork>
Press Enter or type command to continue
----

[,console]
----
   0x000000000000152a <+5>:  48 89 e5             mov    rbp,rsp
   0x000000000000152d <+8>:  b8 00 00 00 00       mov    eax,0x0
   0x0000000000001532 <+13>: e8 21 00 00 00       call   0x1558 <checkFileExist>
   0x0000000000001537 <+18>: 85 c0                test   eax,eax
   0x0000000000001539 <+20>: 74 0e                je     0x1549 <doWork+36>               # jump forward, jump if equal
   0x000000000000153b <+22>: 48 8d 3d fe 0b 00 00 lea    rdi,[rip+0xbfe]        # 0x2140 
   0x0000000000001542 <+29>: e8 e9 fb ff ff       call   0x1130 <puts@plt>
   0x0000000000001547 <+34>: eb 0c                jmp    0x1555 <doWork+48>               # jump forward
   0x0000000000001549 <+36>: 48 8d 3d 50 0c 00 00 lea    rdi,[rip+0xc50]        # 0x21a0 
   0x0000000000001550 <+43>: e8 db fb ff ff       call   0x1130 <puts@plt>
   0x0000000000001555 <+48>: 90                   nop
   0x0000000000001556 <+49>: 5d                   pop    rbp
   0x0000000000001557 <+50>: c3                   ret

~                                                                                                                                                       
~                                                                                                               
~                                                                                                                                                       
~                                                                                                                                                     
~                                                                                                                                                       
:g/ j/p
   0x0000000000001539 <+20>: 74 0e                je     0x1549 <doWork+36>               # jump forward, jump if equal
   0x0000000000001547 <+34>: eb 0c                jmp    0x1555 <doWork+48>               # jump forward
Press ENTER or type command to continue
----

[,console]
----
   0x00000000000015c0 <+0>:  f3 0f 1e fa          endbr64
   0x00000000000015c4 <+4>:  55                   push   rbp
   0x00000000000015c5 <+5>:  48 89 e5             mov    rbp,rsp
   0x00000000000015c8 <+8>:  b8 00 00 00 00       mov    eax,0x0
   0x00000000000015cd <+13>: e8 eb fe ff ff       call   0x14bd <__stack_quality_check>
   0x00000000000015d2 <+18>: 48 8d 3d 4a 0c 00 00 lea    rdi,[rip+0xc4a]        # 0x2223 
   0x00000000000015d9 <+25>: e8 52 fb ff ff       call   0x1130 <puts@plt>
   0x00000000000015de <+30>: b8 00 00 00 00       mov    eax,0x0
   0x00000000000015e3 <+35>: e8 17 ff ff ff       call   0x14ff <prepWork>
   0x00000000000015e8 <+40>: b8 00 00 00 00       mov    eax,0x0
   0x00000000000015ed <+45>: e8 33 ff ff ff       call   0x1525 <doWork>
   0x00000000000015f2 <+50>: b8 00 00 00 00       mov    eax,0x0
   0x00000000000015f7 <+55>: 5d                   pop    rbp
   0x00000000000015f8 <+56>: c3                   ret

~
~
~
~
~
:g/eax/p
   0x00000000000015c8 <+8>:  b8 00 00 00 00       mov    eax,0x0
   0x00000000000015de <+30>: b8 00 00 00 00       mov    eax,0x0
   0x00000000000015e8 <+40>: b8 00 00 00 00       mov    eax,0x0
   0x00000000000015f2 <+50>: b8 00 00 00 00       mov    eax,0x0
Press ENTER or type command to continue
----







Je kunt dgb ook gebruiken om een methode, zonder 'naam', te disassemblen door een beginadres en eindadres
(gescheiden door een komma) op te geven (adressen in HEX) in plaats van methodenaam.

[,console]
----
gdb -batch -ex 'disassemble/rs 0x11b8,0x1237' executable | python beautify.py > main.asm
----









[,console]
----
objdump -M intel -d executable
----

[,console]
----
hexedit executable
----

[,console]
----
^C Exit ^G goTo Offset ^N Next ^X Exit and Save
----


[,console]
----
bless executable
----

https://www.tutorialspoint.com/assembly_programming/assembly_registers.htm

[,python]
----
>>> int("0x1273", 16)
4723
----

[,python]
----
>>> hex(0x12ae + 0x2d6c)
'0x401a'
----



[,console]
----
#!/bin/bash
#cp crack cracknop
python3 -c "import sys; sys.stdout.buffer.write(b'\x90' * 41 )" | dd of=test bs=1 count=41 seek=0 conv=notrunc
----



